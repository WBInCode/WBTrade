# Render Blueprint - automatyczna konfiguracja serwisów
services:
  # API Backend
  - type: web
    name: wbtrade-api
    runtime: docker
    dockerfilePath: ./Dockerfile
    plan: free # Darmowy plan - serwis usypia się po 15 min nieaktywności
    region: frankfurt # EU region dla lepszej wydajności w Polsce
    branch: main # lub master - nazwa głównej gałęzi
    healthCheckPath: /health
    autoDeploy: true # Automatyczne wdrożenia przy push do głównej gałęzi
    
    # Zmienne środowiskowe - WAŻNE: ustaw je w panelu Render
    envVars:
      - key: NODE_ENV
        value: production
      
      - key: APP_PORT
        value: 5000
        
      - key: APP_URL
        # Zostanie automatycznie ustawione przez Render
        sync: false
        
      - key: FRONTEND_URL
        # Ustaw URL swojego frontendu po wdrożeniu
        sync: false
        
      - key: DATABASE_URL
        # Twój URL bazy Neon (skopiuj z .env)
        sync: false
        
      - key: REDIS_URL
        # Twój URL Redis Upstash (skopiuj z .env)
        sync: false
        
      - key: JWT_SECRET
        # Ustaw bezpieczny klucz JWT (min. 32 znaki)
        sync: false
        
      - key: JWT_ACCESS_SECRET
        # Ten sam co JWT_SECRET lub osobny klucz dla access tokenów
        sync: false
        
      - key: JWT_REFRESH_SECRET
        # Ustaw bezpieczny klucz dla refresh tokenów
        sync: false
        
      - key: PAYU_POS_ID
        sync: false
        
      - key: PAYU_CLIENT_ID
        sync: false
        
      - key: PAYU_CLIENT_SECRET
        sync: false
        
      - key: PAYU_SECOND_KEY
        sync: false
        
      - key: PAYU_SANDBOX
        value: false # Na produkcji ustaw na false
        
      - key: MEILI_HOST
        # URL do Meilisearch (można użyć Render lub zewnętrznego serwisu)
        sync: false
        
      - key: MEILI_MASTER_KEY
        # Bezpieczny klucz do Meilisearch
        sync: false
        
      - key: SMTP_HOST
        # Konfiguracja email (np. SendGrid, Postmark)
        sync: false
        
      - key: SMTP_PORT
        value: 587
        
      - key: SMTP_USER
        sync: false
        
      - key: SMTP_PASS
        sync: false
        
      - key: SMTP_FROM
        value: "WBTrade <noreply@wbtrade.pl>"

  # Meilisearch (opcjonalnie - możesz użyć zewnętrznego serwisu)
  - type: web
    name: wbtrade-meilisearch
    runtime: docker
    dockerfilePath: ./Dockerfile.meilisearch
    plan: free # Darmowy plan - serwis usypia się po 15 min nieaktywności
    region: frankfurt
    branch: main
    envVars:
      - key: MEILI_MASTER_KEY
        # Ten sam klucz co w API
        sync: false

databases:
  # Jeśli nie używasz Neon, możesz utworzyć bazę na Render
  # - name: wbtrade-db
  #   plan: starter
  #   databaseName: wbtrade
  #   user: wbtrade
  #   region: frankfurt